<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√≥dulo de Cotizaciones - Sistema Finaxis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            color: #e91e63;
            font-size: 3em;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header .subtitle {
            color: #666;
            font-size: 1.3em;
            margin-bottom: 20px;
        }

        .header .description {
            color: #777;
            font-size: 1.1em;
            max-width: 800px;
            margin: 0 auto;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .section h2 {
            color: #e91e63;
            font-size: 2.2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #e91e63;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section h3 {
            color: #ad1457;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
            padding-left: 15px;
            border-left: 4px solid #ad1457;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .feature-card {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            border-radius: 12px;
            padding: 25px;
            border-left: 5px solid #e91e63;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateX(10px);
            box-shadow: 0 10px 25px rgba(233, 30, 99, 0.2);
        }

        .feature-card h4 {
            color: #e91e63;
            font-size: 1.3em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(233, 30, 99, 0.3);
        }

        .highlight-box h4 {
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .warning-box {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #c44569;
        }

        .warning-box h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .api-endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
        }

        .method.post { background: #28a745; color: white; }
        .method.get { background: #007bff; color: white; }
        .method.put { background: #ffc107; color: black; }
        .method.patch { background: #17a2b8; color: white; }
        .method.delete { background: #dc3545; color: white; }

        .tech-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .spec-item {
            background: #fce4ec;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e91e63;
        }

        .spec-item strong {
            color: #e91e63;
            display: block;
            margin-bottom: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background-color: #fce4ec;
        }

        .workflow-step {
            background: #fce4ec;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 5px solid #e91e63;
            position: relative;
        }

        .workflow-step::before {
            content: attr(data-step);
            position: absolute;
            left: -15px;
            top: 15px;
            background: #e91e63;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 2px;
        }

        .status-borrador {
            background: #f8f9fa;
            color: #6c757d;
            border: 1px solid #dee2e6;
        }

        .status-aprobada {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-facturada {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .status-anulada {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .conclusion {
            background: linear-gradient(135deg, #e91e63, #ad1457);
            color: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-top: 40px;
        }

        .conclusion h2 {
            color: white;
            border-bottom: 3px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .tech-specs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã M√≥dulo de Cotizaciones</h1>
            <div class="subtitle">Sistema Integral de Gesti√≥n Comercial</div>
            <div class="description">
                Plataforma completa para la creaci√≥n, gesti√≥n y seguimiento de cotizaciones comerciales, 
                con flujo de estados automatizado, generaci√≥n de PDF profesional y integraci√≥n seamless 
                con el proceso de facturaci√≥n en el ecosistema Finaxis.
            </div>
        </div>

        <div class="section">
            <h2>üìã Introducci√≥n al Sistema de Cotizaciones</h2>
            <p>
                El m√≥dulo de Cotizaciones de Finaxis es una herramienta estrat√©gica dise√±ada para optimizar 
                el proceso comercial desde la propuesta inicial hasta la conversi√≥n en venta. Permite crear 
                ofertas profesionales, gestionar el ciclo de vida comercial y mantener un control preciso 
                del pipeline de ventas con integraci√≥n directa al sistema de facturaci√≥n.
            </p>

            <div class="highlight-box">
                <h4>üéØ Caracter√≠sticas Principales</h4>
                <ul>
                    <li><strong>Gesti√≥n de Ciclo Completo:</strong> Desde borrador hasta facturaci√≥n con estados controlados</li>
                    <li><strong>Numeraci√≥n Autom√°tica:</strong> Consecutivo autom√°tico por empresa para control ordenado</li>
                    <li><strong>PDF Profesional:</strong> Generaci√≥n autom√°tica de cotizaciones con dise√±o corporativo</li>
                    <li><strong>Integraci√≥n con Inventarios:</strong> Selecci√≥n directa de productos con precios actualizados</li>
                    <li><strong>Conversi√≥n a Factura:</strong> Transformaci√≥n directa de cotizaciones aprobadas en facturas</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üèóÔ∏è Arquitectura del Sistema</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìÑ Gesti√≥n de Documentos</h4>
                    <p>Sistema robusto para crear, editar y gestionar cotizaciones con control de versiones y estados.</p>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Flujo de Estados</h4>
                    <p>Workflow automatizado que gu√≠a las cotizaciones desde borrador hasta facturaci√≥n.</p>
                </div>
                <div class="feature-card">
                    <h4>üìä C√°lculos Autom√°ticos</h4>
                    <p>Procesamiento autom√°tico de totales, subtotales y aplicaci√≥n de precios por producto.</p>
                </div>
                <div class="feature-card">
                    <h4>üìë Generaci√≥n de Reportes</h4>
                    <p>Sistema de reportes PDF con dise√±o profesional y personalizaci√≥n corporativa.</p>
                </div>
            </div>

            <h3>üîß Componentes T√©cnicos</h3>
            <div class="tech-specs">
                <div class="spec-item">
                    <strong>API Router:</strong>
                    <code>/api/cotizaciones/</code>
                </div>
                <div class="spec-item">
                    <strong>Servicio Principal:</strong>
                    <code>service_cotizacion.py</code>
                </div>
                <div class="spec-item">
                    <strong>Esquemas de Datos:</strong>
                    <code>schemas/cotizacion.py</code>
                </div>
                <div class="spec-item">
                    <strong>Modelos de Base de Datos:</strong>
                    <code>Cotizacion, CotizacionDetalle</code>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìù Creaci√≥n y Gesti√≥n de Cotizaciones</h2>
            
            <div class="api-endpoint">
                <span class="method post">POST</span>
                <strong>/api/cotizaciones/</strong> - Crear nueva cotizaci√≥n
            </div>

            <h3>üìä Estructura de Datos</h3>
            <table>
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Requerido</th>
                        <th>Descripci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>fecha</td>
                        <td>Date</td>
                        <td>‚úÖ</td>
                        <td>Fecha de emisi√≥n de la cotizaci√≥n</td>
                    </tr>
                    <tr>
                        <td>fecha_vencimiento</td>
                        <td>Date</td>
                        <td>‚ùå</td>
                        <td>Fecha l√≠mite de validez de la oferta</td>
                    </tr>
                    <tr>
                        <td>tercero_id</td>
                        <td>Integer</td>
                        <td>‚úÖ</td>
                        <td>ID del cliente al que se dirige la cotizaci√≥n</td>
                    </tr>
                    <tr>
                        <td>bodega_id</td>
                        <td>Integer</td>
                        <td>‚ùå</td>
                        <td>Bodega de referencia para disponibilidad</td>
                    </tr>
                    <tr>
                        <td>observaciones</td>
                        <td>Text</td>
                        <td>‚ùå</td>
                        <td>Notas adicionales y condiciones especiales</td>
                    </tr>
                    <tr>
                        <td>detalles</td>
                        <td>Array</td>
                        <td>‚úÖ</td>
                        <td>Lista de productos cotizados</td>
                    </tr>
                </tbody>
            </table>

            <h3>üõçÔ∏è Estructura de Detalles</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üì¶ Producto</h4>
                    <p><strong>producto_id:</strong> Identificador √∫nico del producto a cotizar con informaci√≥n completa.</p>
                </div>
                <div class="feature-card">
                    <h4>üìä Cantidad</h4>
                    <p><strong>cantidad:</strong> Cantidad ofertada del producto (debe ser mayor a 0).</p>
                </div>
                <div class="feature-card">
                    <h4>üíµ Precio Unitario</h4>
                    <p><strong>precio_unitario:</strong> Precio ofertado por unidad (puede diferir del precio base).</p>
                </div>
                <div class="feature-card">
                    <h4>üìà Control de Facturaci√≥n</h4>
                    <p><strong>cantidad_facturada:</strong> Seguimiento de conversi√≥n parcial a facturas.</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üîÑ Flujo de Estados y Ciclo de Vida</h2>
            
            <h3>üìã Estados de Cotizaci√≥n</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4><span class="status-badge status-borrador">BORRADOR</span></h4>
                    <p>Estado inicial editable. Permite modificaciones completas de contenido y estructura.</p>
                </div>
                <div class="feature-card">
                    <h4><span class="status-badge status-aprobada">APROBADA</span></h4>
                    <p>Oferta firme enviada al cliente. No permite modificaciones, solo cambio de estado.</p>
                </div>
                <div class="feature-card">
                    <h4><span class="status-badge status-facturada">FACTURADA</span></h4>
                    <p>Cotizaci√≥n convertida exitosamente en factura. Estado final positivo.</p>
                </div>
                <div class="feature-card">
                    <h4><span class="status-badge status-anulada">ANULADA</span></h4>
                    <p>Cotizaci√≥n cancelada o rechazada. Estado final sin posibilidad de reactivaci√≥n.</p>
                </div>
            </div>

            <h3>üîÑ Workflow de Transiciones</h3>
            <div class="workflow-step" data-step="1">
                <h4>Creaci√≥n en Borrador</h4>
                <p>Nueva cotizaci√≥n se crea autom√°ticamente en estado BORRADOR con numeraci√≥n consecutiva y c√°lculo autom√°tico de totales.</p>
            </div>

            <div class="workflow-step" data-step="2">
                <h4>Edici√≥n y Refinamiento</h4>
                <p>En estado BORRADOR se pueden realizar modificaciones ilimitadas: agregar/quitar productos, cambiar cantidades, precios y datos generales.</p>
            </div>

            <div class="workflow-step" data-step="3">
                <h4>Aprobaci√≥n y Env√≠o</h4>
                <p>Cambio a estado APROBADA convierte la cotizaci√≥n en oferta firme. Se bloquean las ediciones y se habilita la generaci√≥n de PDF.</p>
            </div>

            <div class="workflow-step" data-step="4">
                <h4>Conversi√≥n o Anulaci√≥n</h4>
                <p>Desde APROBADA se puede convertir a FACTURADA (√©xito comercial) o ANULADA (rechazo/cancelaci√≥n).</p>
            </div>

            <div class="api-endpoint">
                <span class="method patch">PATCH</span>
                <strong>/api/cotizaciones/{id}/estado</strong> - Cambiar estado de cotizaci√≥n
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Reglas de Transici√≥n</h4>
                <ul>
                    <li>Solo se puede aprobar desde estado BORRADOR</li>
                    <li>Las cotizaciones ANULADAS no pueden cambiar de estado</li>
                    <li>El estado FACTURADA se asigna autom√°ticamente al convertir a factura</li>
                    <li>Las modificaciones solo est√°n permitidas en estado BORRADOR</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üìä Consulta y Filtrado</h2>
            
            <div class="api-endpoint">
                <span class="method get">GET</span>
                <strong>/api/cotizaciones/</strong> - Listar cotizaciones con filtros
            </div>

            <h3>üîç Filtros Disponibles</h3>
            <table>
                <thead>
                    <tr>
                        <th>Par√°metro</th>
                        <th>Tipo</th>
                        <th>Descripci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>numero</td>
                        <td>Integer</td>
                        <td>B√∫squeda por n√∫mero espec√≠fico de cotizaci√≥n</td>
                    </tr>
                    <tr>
                        <td>tercero_id</td>
                        <td>Integer</td>
                        <td>Filtrar por cliente espec√≠fico</td>
                    </tr>
                    <tr>
                        <td>estado</td>
                        <td>String</td>
                        <td>Filtrar por estado (BORRADOR, APROBADA, etc.)</td>
                    </tr>
                    <tr>
                        <td>fecha_inicio</td>
                        <td>Date</td>
                        <td>Fecha m√≠nima de emisi√≥n</td>
                    </tr>
                    <tr>
                        <td>fecha_fin</td>
                        <td>Date</td>
                        <td>Fecha m√°xima de emisi√≥n</td>
                    </tr>
                    <tr>
                        <td>skip / limit</td>
                        <td>Integer</td>
                        <td>Paginaci√≥n de resultados</td>
                    </tr>
                </tbody>
            </table>

            <h3>üìà Informaci√≥n Enriquecida</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üë§ Datos del Cliente</h4>
                    <p>Informaci√≥n completa del tercero incluyendo raz√≥n social y datos de contacto.</p>
                </div>
                <div class="feature-card">
                    <h4>üè™ Informaci√≥n de Bodega</h4>
                    <p>Nombre y detalles de la bodega asociada cuando aplique.</p>
                </div>
                <div class="feature-card">
                    <h4>üì¶ Detalles de Productos</h4>
                    <p>C√≥digo, nombre y especificaciones completas de cada producto cotizado.</p>
                </div>
                <div class="feature-card">
                    <h4>üí∞ Totales Calculados</h4>
                    <p>Total estimado autom√°tico y subtotales por l√≠nea de producto.</p>
                </div>
            </div>

            <div class="api-endpoint">
                <span class="method get">GET</span>
                <strong>/api/cotizaciones/{id}</strong> - Obtener cotizaci√≥n espec√≠fica
            </div>
        </div>

        <div class="section">
            <h2>üìÑ Generaci√≥n de PDF Profesional</h2>
            
            <div class="api-endpoint">
                <span class="method get">GET</span>
                <strong>/api/cotizaciones/{id}/pdf</strong> - Descargar PDF de cotizaci√≥n
            </div>

            <h3>üé® Caracter√≠sticas del PDF</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üè¢ Dise√±o Corporativo</h4>
                    <p>Encabezado con informaci√≥n completa de la empresa: raz√≥n social, NIT, direcci√≥n y contacto.</p>
                </div>
                <div class="feature-card">
                    <h4>üìã Informaci√≥n del Cliente</h4>
                    <p>Secci√≥n destacada con datos completos del cliente y informaci√≥n de contacto.</p>
                </div>
                <div class="feature-card">
                    <h4>üìä Tabla de Productos</h4>
                    <p>Listado detallado con c√≥digo, descripci√≥n, cantidad, precio unitario y totales.</p>
                </div>
                <div class="feature-card">
                    <h4>üí∞ Resumen Financiero</h4>
                    <p>Total estimado destacado con formato profesional y f√°cil lectura.</p>
                </div>
            </div>

            <h3>‚öôÔ∏è Tecnolog√≠a de Generaci√≥n</h3>
            <div class="highlight-box">
                <h4>üîß Stack T√©cnico</h4>
                <ul>
                    <li><strong>WeasyPrint:</strong> Motor de renderizado HTML a PDF de alta calidad</li>
                    <li><strong>Jinja2:</strong> Sistema de templates para contenido din√°mico</li>
                    <li><strong>CSS Avanzado:</strong> Estilos profesionales con soporte para impresi√≥n</li>
                    <li><strong>Responsive Design:</strong> Adaptaci√≥n autom√°tica a formato carta</li>
                    <li><strong>Datos en Tiempo Real:</strong> Informaci√≥n actualizada directamente de base de datos</li>
                </ul>
            </div>

            <h3>üìã Elementos del Template</h3>
            <table>
                <thead>
                    <tr>
                        <th>Secci√≥n</th>
                        <th>Contenido</th>
                        <th>Fuente de Datos</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Encabezado Empresarial</td>
                        <td>Logo, raz√≥n social, NIT, contacto</td>
                        <td>Tabla empresas</td>
                    </tr>
                    <tr>
                        <td>Informaci√≥n del Documento</td>
                        <td>N√∫mero, fecha, vencimiento</td>
                        <td>Tabla cotizaciones</td>
                    </tr>
                    <tr>
                        <td>Datos del Cliente</td>
                        <td>Raz√≥n social, identificaci√≥n, direcci√≥n</td>
                        <td>Tabla terceros</td>
                    </tr>
                    <tr>
                        <td>Detalle de Productos</td>
                        <td>C√≥digo, nombre, cantidad, precios</td>
                        <td>Tabla cotizaciones_detalles + productos</td>
                    </tr>
                    <tr>
                        <td>Totales</td>
                        <td>Total estimado calculado</td>
                        <td>C√°lculo autom√°tico</td>
                    </tr>
                    <tr>
                        <td>Observaciones</td>
                        <td>Notas y condiciones especiales</td>
                        <td>Campo observaciones</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üîÑ Actualizaci√≥n y Modificaci√≥n</h2>
            
            <div class="api-endpoint">
                <span class="method put">PUT</span>
                <strong>/api/cotizaciones/{id}</strong> - Actualizar cotizaci√≥n completa
            </div>

            <h3>‚úèÔ∏è Reglas de Edici√≥n</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìù Solo en Borrador</h4>
                    <p>Las modificaciones √∫nicamente est√°n permitidas cuando la cotizaci√≥n est√° en estado BORRADOR.</p>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Reemplazo Completo</h4>
                    <p>La actualizaci√≥n reemplaza completamente los detalles existentes con los nuevos datos.</p>
                </div>
                <div class="feature-card">
                    <h4>üí∞ Rec√°lculo Autom√°tico</h4>
                    <p>El total estimado se recalcula autom√°ticamente al actualizar los detalles.</p>
                </div>
                <div class="feature-card">
                    <h4>üîí Validaci√≥n de Estado</h4>
                    <p>El sistema valida el estado antes de permitir cualquier modificaci√≥n.</p>
                </div>
            </div>

            <h3>‚öôÔ∏è Proceso de Actualizaci√≥n</h3>
            <div class="highlight-box">
                <h4>üìã Pasos del Proceso</h4>
                <ol>
                    <li><strong>Validaci√≥n de Existencia:</strong> Verificar que la cotizaci√≥n existe y pertenece a la empresa</li>
                    <li><strong>Validaci√≥n de Estado:</strong> Confirmar que est√° en estado BORRADOR</li>
                    <li><strong>Actualizaci√≥n de Cabecera:</strong> Modificar datos generales (fecha, cliente, observaciones)</li>
                    <li><strong>Eliminaci√≥n de Detalles:</strong> Remover todos los detalles existentes</li>
                    <li><strong>Inserci√≥n de Nuevos Detalles:</strong> Agregar los nuevos productos y cantidades</li>
                    <li><strong>Rec√°lculo de Totales:</strong> Actualizar el total estimado autom√°ticamente</li>
                </ol>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Consideraciones Importantes</h4>
                <ul>
                    <li>La actualizaci√≥n es una operaci√≥n de reemplazo completo, no incremental</li>
                    <li>Todos los detalles anteriores se eliminan y se crean nuevos</li>
                    <li>El campo cantidad_facturada se resetea a 0 en los nuevos detalles</li>
                    <li>La operaci√≥n es transaccional: todo o nada para mantener consistencia</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üîó Integraci√≥n con Facturaci√≥n</h2>
            
            <h3>üîÑ Conversi√≥n a Factura</h3>
            <p>
                El sistema permite convertir cotizaciones aprobadas directamente en facturas, manteniendo 
                la trazabilidad completa y actualizando autom√°ticamente el estado de la cotizaci√≥n.
            </p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üìã Transferencia de Datos</h4>
                    <p>Todos los detalles de productos, cantidades y precios se transfieren autom√°ticamente a la factura.</p>
                </div>
                <div class="feature-card">
                    <h4>üîó Trazabilidad</h4>
                    <p>La factura mantiene referencia a la cotizaci√≥n original para auditor√≠a y seguimiento.</p>
                </div>
                <div class="feature-card">
                    <h4>üìä Control de Conversi√≥n</h4>
                    <p>Sistema de seguimiento de cantidades facturadas vs. cantidades cotizadas.</p>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Actualizaci√≥n Autom√°tica</h4>
                    <p>El estado de la cotizaci√≥n cambia autom√°ticamente a FACTURADA al completar la conversi√≥n.</p>
                </div>
            </div>

            <h3>‚öôÔ∏è Proceso de Conversi√≥n</h3>
            <div class="highlight-box">
                <h4>üìã Flujo de Integraci√≥n</h4>
                <ul>
                    <li><strong>Validaci√≥n de Estado:</strong> Verificar que la cotizaci√≥n est√© APROBADA</li>
                    <li><strong>Creaci√≥n de Factura:</strong> Generar nueva factura con datos de la cotizaci√≥n</li>
                    <li><strong>Transferencia de Detalles:</strong> Copiar productos, cantidades y precios</li>
                    <li><strong>Actualizaci√≥n de Trazabilidad:</strong> Establecer referencia cotizacion_id en factura</li>
                    <li><strong>Cambio de Estado:</strong> Marcar cotizaci√≥n como FACTURADA</li>
                    <li><strong>Procesamiento Contable:</strong> Ejecutar l√≥gica contable normal de facturaci√≥n</li>
                </ul>
            </div>

            <h3>üìä Control de Facturaci√≥n Parcial</h3>
            <table>
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Prop√≥sito</th>
                        <th>Uso Futuro</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>cantidad_facturada</td>
                        <td>Seguimiento de conversi√≥n</td>
                        <td>Facturaci√≥n parcial de cotizaciones</td>
                    </tr>
                    <tr>
                        <td>Estado FACTURADA</td>
                        <td>Control de ciclo completo</td>
                        <td>Identificaci√≥n de cotizaciones convertidas</td>
                    </tr>
                    <tr>
                        <td>Referencia en Factura</td>
                        <td>Trazabilidad bidireccional</td>
                        <td>Reportes de conversi√≥n y an√°lisis</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üîê Seguridad y Validaciones</h2>
            
            <h3>üõ°Ô∏è Controles de Seguridad</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üë§ Autenticaci√≥n</h4>
                    <p>Validaci√≥n de usuario activo y permisos de acceso al m√≥dulo de cotizaciones.</p>
                </div>
                <div class="feature-card">
                    <h4>üè¢ Contexto Empresarial</h4>
                    <p>Todas las operaciones se realizan dentro del contexto de la empresa del usuario.</p>
                </div>
                <div class="feature-card">
                    <h4>üìã Validaci√≥n de Datos</h4>
                    <p>Verificaci√≥n exhaustiva de la integridad y consistencia de los datos ingresados.</p>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Transacciones</h4>
                    <p>Uso de transacciones de base de datos para garantizar la consistencia de los datos.</p>
                </div>
            </div>

            <h3>‚úÖ Validaciones Implementadas</h3>
            <div class="highlight-box">
                <h4>üîç Validaciones de Negocio</h4>
                <ul>
                    <li><strong>Existencia de Terceros:</strong> Verificaci√≥n de que el cliente existe y pertenece a la empresa</li>
                    <li><strong>Productos V√°lidos:</strong> Validaci√≥n de que todos los productos existen y est√°n activos</li>
                    <li><strong>Cantidades Positivas:</strong> Verificaci√≥n de que las cantidades sean mayores a cero</li>
                    <li><strong>Precios No Negativos:</strong> Validaci√≥n de que los precios unitarios no sean negativos</li>
                    <li><strong>Estados V√°lidos:</strong> Control de transiciones de estado seg√∫n reglas de negocio</li>
                    <li><strong>Permisos de Edici√≥n:</strong> Verificaci√≥n de que solo se editen cotizaciones en BORRADOR</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üìà Casos de Uso Pr√°cticos</h2>
            
            <h3>üõçÔ∏è Escenarios Comerciales</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üè™ Ventas al Detalle</h4>
                    <p>Cotizaciones r√°pidas para clientes con productos de inventario y precios est√°ndar.</p>
                </div>
                <div class="feature-card">
                    <h4>üè≠ Ventas Industriales</h4>
                    <p>Cotizaciones complejas con m√∫ltiples productos, cantidades grandes y precios negociados.</p>
                </div>
                <div class="feature-card">
                    <h4>üíº Servicios Profesionales</h4>
                    <p>Propuestas de servicios con descripci√≥n detallada y precios por hora o proyecto.</p>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Ventas Recurrentes</h4>
                    <p>Cotizaciones base que se pueden duplicar y modificar para clientes frecuentes.</p>
                </div>
            </div>

            <h3>üí° Beneficios Empresariales</h3>
            <div class="highlight-box">
                <h4>üéØ Ventajas Operativas</h4>
                <ul>
                    <li><strong>Profesionalizaci√≥n:</strong> Documentos PDF con dise√±o corporativo y presentaci√≥n profesional</li>
                    <li><strong>Control de Pipeline:</strong> Seguimiento completo del proceso comercial desde cotizaci√≥n hasta factura</li>
                    <li><strong>Eficiencia Operativa:</strong> Conversi√≥n directa a factura sin re-digitaci√≥n de datos</li>
                    <li><strong>Trazabilidad Completa:</strong> Historial completo de ofertas, aprobaciones y conversiones</li>
                    <li><strong>An√°lisis Comercial:</strong> Datos estructurados para an√°lisis de tasas de conversi√≥n y efectividad</li>
                </ul>
            </div>
        </div>

        <div class="conclusion">
            <h2>üéØ Resumen del M√≥dulo de Cotizaciones</h2>
            <p>
                El M√≥dulo de Cotizaciones de Finaxis representa una soluci√≥n integral para la gesti√≥n comercial 
                moderna, combinando facilidad de uso con funcionalidades avanzadas de control y seguimiento. 
                Con su flujo de estados automatizado, generaci√≥n de PDF profesional e integraci√≥n seamless con 
                facturaci√≥n, optimiza completamente el proceso comercial desde la propuesta inicial hasta la 
                conversi√≥n en venta efectiva.
            </p>
            <br>
            <p>
                <strong>Caracter√≠sticas destacadas:</strong> Workflow de estados controlado, numeraci√≥n autom√°tica, 
                PDF corporativo, integraci√≥n con inventarios, conversi√≥n directa a factura y sistema completo 
                de validaciones que garantizan la integridad de los datos y la profesionalidad en la gesti√≥n 
                comercial empresarial.
            </p>
        </div>
    </div>
</body>
</html>